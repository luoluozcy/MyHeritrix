(function(a,d){var f=function(g,i){this.config=g;this.change=i},c=null,b=null,e=function(){return false};f.dealConfig=function(g,j){var i={callback:d.noop};if(d.isFunction(g)){i.callback=g;g={}}else{if(d.isFunction(j)){i.callback=j}}i.config=d.extend({},f.config,g||{});return i};f.hide=function(){if(b){b.list.find("a").removeClass("."+b.config.hoverCss).end().hide();b.wrap.removeClass(b.config.hitCss);b=null}d(document).unbind("mousedown",f.hide);c=null};f.config={wrap:".mcSelectBox",holder:".imitateSelect",list:".optionList",hoverCss:"iSelectHover",minHeight:0,flowCss:"listOverFlow",hitCss:"opened",method:"click"};f.prototype={init:function(){var m=d(this.config.wrap),n=m.find(this.config.list),l=m.find(this.config.holder),g,i=this,k=i.config.hoverCss,o=this.config.method;this.type=l[0].tagName.toLowerCase();this.holder=l;this.wrap=m;this.list=n;if(o=="click"){l.parent().mousedown(function(p){if(p.button==("\v"=="v"?1:0)){i.show();if(i.type=="a"){p.preventDefault()}if(!d(p.target).closest(i.config.list).length){p.stopPropagation()}}})}if({mouseover:1,mouseenter:1}[o]){var j=function(){this.stimer&&a.clearTimeout(this.stimer);this.htimer&&a.clearTimeout(this.htimer)};l.parent().bind({mouseenter:function(){j.call(this);this.stimer=a.setTimeout(function(){i.show()},200)},mouseleave:function(){j.call(this);this.htimer=a.setTimeout(function(){f.hide()},100)}})}if(this.type=="a"){l.click(e)}n.delegate("a","mouseenter",function(){n.find("."+k).removeClass(k);d(this).addClass(k)}).delegate("a","mousedown",function(q){var p=i.type,r={oldVal:{a:l[0].href,span:l.text(),input:l[0].value}[p],newVal:{a:this.href}[p]||this.hash.substr(1)};if(r.oldVal!=r.newVal){switch(p){case"a":l[0].href=this.href;l.text(d(this).text());break;case"span":l.text(this.hash.substr(1));l[0].title=d(this).text();break;case"input":l[0].value=this.hash.substr(1);break}r.target=l[0];r.wrap=m[0];r.option=this;r.type="i.change";r.value=r.newVal;i.change.call(r.target,r);l.trigger(r)}}).delegate("a","click",e).mousedown(function(p){if(p.target.tagName.toLowerCase()!=="a"){return false}});if(this.config.minHeight>0){n.show();h=n.outerHeight();n.hide();if(h>this.config.minHeight){n.width(g-2).height(this.config.minHeight).addClass(this.config.flowCss)}}this.init=function(){}},show:function(){f.hide();if(c==this.wrap[0]){return}c=this.wrap[0];b=this;this.list.show();this.wrap.addClass(this.config.hitCss);var j=this.type,i=this.holder,g=this.config.hoverCss;this.list.find("a").removeClass(g);d(document).mousedown(f.hide)}};d.fn.jSelect=function(g,j){var i=f.dealConfig(g,j);i.config.wrap=this;d.jSelect(i.config,i.callback);return this};d.jSelect=function(g,j){var i=f.dealConfig(g,j);d(i.config.wrap).each(function(){var k=d(this),l=d.extend({},i.config,{wrap:k});(new f(l,i.callback)).init()})};d.jSelect.hide=function(){f.hide()}})(window,jQuery);